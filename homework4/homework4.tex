%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Welcome to writeLaTeX --- just edit your LaTeX on the left,
% and we'll compile it for you on the right. If you give
% someone the link to this page, they can edit at the same
% time. See the help menu above for more info. Enjoy!
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% --------------------------------------------------------------
% This is all preamble stuff that you don't have to worry about.
% Head down to where it says "Start here"
% --------------------------------------------------------------
 
\documentclass[12pt]{article}
 
\usepackage[margin=1in]{geometry}
\usepackage{amsmath,amsthm,amssymb}

\usepackage{listings}
\usepackage{xcolor}

\usepackage{tikz}
\usetikzlibrary{shapes,positioning}

\tikzset{ell/.style={circle,draw,minimum height=0.5cm,minimum width=0.5cm,inner sep=0.2cm}}
\tikzset{rec/.style={rectangle,draw,minimum height=0.5cm,minimum width=0.5cm,inner sep=0.2cm}}

%New colors defined below
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

%Code listing style named "mystyle"
\lstdefinestyle{mystyle}{
  backgroundcolor=\color{backcolour}, commentstyle=\color{codegreen},
  keywordstyle=\color{magenta},
  numberstyle=\tiny\color{codegray},
  stringstyle=\color{codepurple},
  basicstyle=\ttfamily\footnotesize,
  breakatwhitespace=false,         
  breaklines=true,                 
  captionpos=b,                    
  keepspaces=true,                 
  numbers=left,                    
  numbersep=5pt,                  
  showspaces=false,                
  showstringspaces=false,
  showtabs=false,                  
  tabsize=2
}

%"mystyle" code listing set
\lstset{style=mystyle}

 
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
 
\newenvironment{theorem}[2][Theorem]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{lemma}[2][Lemma]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{exercise}[2][Exercise]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{problem}[2][Problem]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{question}[2][Question]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{corollary}[2][Corollary]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}

\newenvironment{solution}{\begin{proof}[Solution]}{\end{proof}}
 
\begin{document}
 
% --------------------------------------------------------------
%                         Start here
% --------------------------------------------------------------
 
\title{Homework 4}%replace X with the appropriate number
\author{Mengxiang Jiang\\ %replace with your name
CSEN 5350 Application of Neural Networks} %if necessary, replace with your course title
 
\maketitle

\begin{problem}{Computational Graph}
Draw a computational graph of this equation: $f(x,y,z)= xy + z^3 + x$ and its partial
derivatives with respect to $x$, $y$, and $z$ at $x = -1$, $y = 2$, $z = 3$.\\\\
    \begin{tikzpicture}[>=stealth]
        \node[ell] (x) at (0,8) {$x = -1$}; 
        \node[ell] (y) at (3,8) {$y = 2$};  
        \node[ell] (z) at (6,8) {$z = 3$};

        \node[rec] (mul) at (2,6) {*};
        \node[rec] (cube) at (4,6) {$()^3$};
        \node[rec] (add1) at (3,4) {+};
        \node[rec] (add2) at (3,2) {+};
        \node[rec] (output) at (3,0) {output};

        \draw [->] (x) to []node[]{} (mul);
        \draw [->] (y) to []node[]{} (mul);
        \draw [->] (z) to []node[]{} (cube);
        \draw [->] (mul) to [left]node[]{$a = xy = -2$} (add1);
        \draw [->] (cube) to [right]node[]{$b = z^3=27$} (add1);
        \draw [->] (add1) to [right]node[]{$c = xy+z^3=25$} (add2);
        \draw [->] (x) to [bend right=40,left]node[]{$d = x = -1$} (add2);
        \draw [->] (add2) to [left]node[]{\tiny$f(x,y,z)=xy+z^3+x=24$} (output);
    \end{tikzpicture}
    \qquad
    \begin{tikzpicture}[>=stealth]
      \node[ell,label={\tiny$\frac{\partial f}{\partial x}=\frac{\partial f}{\partial d} + \frac{\partial a}{\partial x} = 3$}] (x) at (0,8) {$x = -1$};
      \node[ell,label={\tiny$\frac{\partial f}{\partial y}=\frac{\partial f}{\partial c}\frac{\partial c}{\partial a}\frac{\partial a}{\partial y} = -1$}] (y) at (3,8) {$y = 2$};  
      \node[ell,label={\tiny$\frac{\partial f}{\partial z}=\frac{\partial f}{\partial c}\frac{\partial c}{\partial b}\frac{\partial b}{\partial z} = 27$}] (z) at (6,8) {$z = 3$};

      \node[rec] (mul) at (2,6) {*};
      \node[rec] (cube) at (4,6) {$()^3$};
      \node[rec] (add1) at (3,4) {+};
      \node[rec] (add2) at (3,2) {+};
      \node[rec] (output) at (3,0) {output};

      \draw [<-] (x) to [left]node[]{\tiny$\frac{\partial a}{\partial x}=y=2$} (mul);
      \draw [<-] (y) to [right]node[]{\tiny$\frac{\partial a}{\partial y}=x=-1$} (mul);
      \draw [<-] (z) to [right]node[]{\tiny$\frac{\partial b}{\partial z}=3z^2=27$} (cube);
      \draw [<-] (mul) to [left]node[]{$\frac{\partial c}{\partial a}=1$} (add1);
      \draw [<-] (cube) to [right]node[]{$\frac{\partial c}{\partial b}=1$} (add1);
      \draw [<-] (add1) to [right]node[]{$\frac{\partial f}{\partial c}=1$} (add2);
      \draw [<-] (x) to [bend right=40,left]node[]{$\frac{\partial f}{\partial d} = 1$} (add2);
      \draw [<-] (add2) to [left]node[]{\tiny$f(x,y,z)=xy+z^3+x=24$} (output);
  \end{tikzpicture}


\end{problem}
% --------------------------------------------------------------
%     You don't have to mess with anything below this line.
% --------------------------------------------------------------
 
\end{document}